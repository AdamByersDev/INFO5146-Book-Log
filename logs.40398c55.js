let e,t,n,l,d,i,r,a,o,u,c,m,s,g;function h(e){return e&&e.__esModule?e.default:e}var p=globalThis,E={},f={},v=p.parcelRequire94c2;null==v&&((v=function(e){if(e in E)return E[e].exports;if(e in f){var t=f[e];delete f[e];var n={id:e,exports:{}};return E[e]=n,t.call(n.exports,n,n.exports),n.exports}var l=Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}).register=function(e,t){f[e]=t},p.parcelRequire94c2=v),v.register;var y=v("lR3v8"),I=v("47Mwn"),B=v("9HrqM");h(y).setLevel("info"),h(y).info("Application started");let T=[],L=[];const x=JSON.parse(localStorage.getItem("email")),b=JSON.parse(localStorage.getItem("userID"));async function w(){let e=(0,B.query)((0,B.collection)(I.db,"logs",b,"logs"),(0,B.orderBy)("addTime","desc"));return await (0,B.getDocs)(e)}async function C(e,t,n,l,d){return(await (0,B.addDoc)((0,B.collection)(I.db,"logs",b,"logs"),{title:e,author:t,genre:n,rating:l,thoughts:d,addTime:(0,B.Timestamp).now(),deleted:!1})).id}async function k(e){(0,B.updateDoc)((0,B.doc)(I.db,"logs",b,"logs",e),{deleted:!0}),document.getElementById(`id_${e}`).remove()}async function D(){g||(g=[],(await w()).docs.forEach(e=>{let t=e.data();t.deleted||g.push({id:e.id,data:{title:t.title,author:t.author,genre:t.genre,rating:parseInt(t.rating),thoughts:t.thoughts}})})),e.innerHTML="",g.forEach(e=>{let l=e.data;$(l.author),M(l.genre),0==t.value.length&&0==n.value.length?O(e.id,l.title,l.author,l.genre,l.rating,l.thoughts):0==t.value&&n.value==l.genre?O(e.id,l.title,l.author,l.genre,l.rating,l.thoughts):t.value==l.author&&0==n.value?O(e.id,l.title,l.author,l.genre,l.rating,l.thoughts):t.value==l.author&&n.value==l.genre&&O(e.id,l.title,l.author,l.genre,l.rating,l.thoughts)})}function $(e){if(!T.includes(e)){T.push(e),T.sort(),t.innerHTML="";let n=document.createElement("option");n.value="",n.innerText="Author",t.appendChild(n),T.forEach(e=>{let n=document.createElement("option");n.value=e,n.innerText=e,t.appendChild(n)})}}function M(e){if(!L.includes(e)){L.push(e),L.sort(),n.innerHTML="";let t=document.createElement("option");t.value="",t.innerText="Genre",n.appendChild(t),L.forEach(e=>{let t=document.createElement("option");t.value=e,t.innerText=e,n.appendChild(t)})}}function O(t,n,l,d,r,g,h=!1,p=!1){let E=document.createElement("h3");E.innerText=n;let f=document.createElement("p"),v="";for(let e=1;e<=r;e++)v+="★";f.innerText=v.padEnd(5,"☆"),f.ariaLabel=`Rated ${r} of 5`;let y=document.createElement("p");y.innerText=l,y.ariaLabel=`By ${l}`;let I=document.createElement("p");I.innerText=d,I.ariaLabel=`Genre ${d}`;let B=document.createElement("div");B.appendChild(E),B.appendChild(f),B.appendChild(y),B.appendChild(I);let T=document.createElement("p");T.innerText=g;let L=document.createElement("button");L.type="button",L.innerText="Delete",L.addEventListener("click",()=>{confirm(`Are you sure you want to delete ${n}.`)&&k(t)});let x=document.createElement("button");x.type="button",x.innerText="Edit",x.addEventListener("click",()=>{i.style.display="block",a.value=n,o.value=l,u.value=d,c.value=`${r}`,m.value=g,s.value=t});let b=document.createElement("div");b.append(L),b.append(x);let w=document.createElement("li");w.id=`id_${t}`,w.appendChild(B),w.appendChild(T),w.appendChild(b),h?e.prepend(w):p?p.after(w):e.appendChild(w)}function S(e){let t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","&":"&amp;","/":"&#x2F;"};return e.replace(/[<>"'&/]/g,e=>t[e])}async function _(e){e.preventDefault();let t=Object.fromEntries(new FormData(e.target).entries()),n=S(t.title.trim()),i=S(t.author.trim()),r=S(t.genre.trim()),a=parseInt(t.rating),o=S(t.thoughts.trim()),u=!1;if(n.length<1?u=!0:i.length<1?u=!0:r.length<1&&(u=!0),u){alert("You must fill in all fields.");return}l.style.display="none",d.reset(),M(r),$(i);let c=await C(n,i,r,a,o);g.push({id:c,data:{title:n,author:i,genre:r,rating:parseInt(a),thoughts:o}}),O(c,n,i,r,a,o,!0)}function F(e){e.preventDefault();let t=Object.fromEntries(new FormData(e.target).entries()),n=t.id,l=S(t.title.trim()),d=S(t.author.trim()),r=S(t.genre.trim()),a=parseInt(t.rating),o=S(t.thoughts.trim()),u=!1;if(l.length<1?u=!0:d.length<1?u=!0:r.length<1&&(u=!0),u){alert("You must fill in all fields.");return}(0,B.updateDoc)((0,B.doc)(I.db,"logs",b,"logs",n),{title:l,author:d,genre:r,rating:a,thoughts:o}),g.find(e=>e.id==n).data={title:l,author:d,genre:r,rating:a,thoughts:o},M(r),$(d);let c=document.getElementById(`id_${n}`);c.id="tempId",O(n,l,d,r,a,o,!1,c),i.style.display="none",g.fin,c.remove()}x||(window.location.href="index.html"),window.addEventListener("load",()=>{document.getElementById("logout").addEventListener("click",()=>{localStorage.removeItem("email"),window.location.href="index.html"}),e=document.getElementById("logList"),(t=document.getElementById("authorFilter")).addEventListener("change",()=>{D()}),(n=document.getElementById("genreFilter")).addEventListener("change",()=>{D()}),document.getElementById("add").addEventListener("click",()=>{l.style.display="block"}),document.getElementById("closeAdd").addEventListener("click",()=>{l.style.display="none",d.reset()}),l=document.getElementById("addBookSection"),(d=document.getElementById("addBook")).addEventListener("submit",_),i=document.getElementById("editBookSection"),(r=document.getElementById("editBook")).addEventListener("submit",F),a=document.getElementById("editTitle"),o=document.getElementById("editAuthor"),u=document.getElementById("editGenre"),c=document.getElementById("editRating"),m=document.getElementById("editThoughts"),s=document.getElementById("editId"),document.getElementById("closeEdit").addEventListener("click",()=>{i.style.display="none",r.reset()}),D()});
//# sourceMappingURL=logs.40398c55.js.map
