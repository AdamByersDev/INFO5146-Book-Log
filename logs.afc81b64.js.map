{"mappings":"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","sources":["<anon>","assets/js/script.js"],"sourcesContent":["\nfunction $parcel$interopDefault(a) {\n  return a && a.__esModule ? a.default : a;\n}\n\n      var $parcel$global = globalThis;\n    \nvar $parcel$modules = {};\nvar $parcel$inits = {};\n\nvar parcelRequire = $parcel$global[\"parcelRequire94c2\"];\n\nif (parcelRequire == null) {\n  parcelRequire = function(id) {\n    if (id in $parcel$modules) {\n      return $parcel$modules[id].exports;\n    }\n    if (id in $parcel$inits) {\n      var init = $parcel$inits[id];\n      delete $parcel$inits[id];\n      var module = {id: id, exports: {}};\n      $parcel$modules[id] = module;\n      init.call(module.exports, module, module.exports);\n      return module.exports;\n    }\n    var err = new Error(\"Cannot find module '\" + id + \"'\");\n    err.code = 'MODULE_NOT_FOUND';\n    throw err;\n  };\n\n  parcelRequire.register = function register(id, init) {\n    $parcel$inits[id] = init;\n  };\n\n  $parcel$global[\"parcelRequire94c2\"] = parcelRequire;\n}\n\nvar parcelRegister = parcelRequire.register;\n\nvar $lR3v8 = parcelRequire(\"lR3v8\");\n\nvar $47Mwn = parcelRequire(\"47Mwn\");\n\nvar $9HrqM = parcelRequire(\"9HrqM\");\n(0, (/*@__PURE__*/$parcel$interopDefault($lR3v8))).setLevel(\"info\");\n(0, (/*@__PURE__*/$parcel$interopDefault($lR3v8))).info(\"Application started\");\nlet $1395f6bf4db21581$var$logList;\nlet $1395f6bf4db21581$var$authorFilter;\nlet $1395f6bf4db21581$var$genreFilter;\nlet $1395f6bf4db21581$var$addBookSection;\nlet $1395f6bf4db21581$var$addBook;\nlet $1395f6bf4db21581$var$logs;\nlet $1395f6bf4db21581$var$authors = [];\nlet $1395f6bf4db21581$var$genres = [];\nconst $1395f6bf4db21581$var$email = JSON.parse(localStorage.getItem(\"email\"));\nconst $1395f6bf4db21581$var$userId = JSON.parse(localStorage.getItem(\"userID\"));\nif (!$1395f6bf4db21581$var$email) window.location.href = \"index.html\";\nasync function $1395f6bf4db21581$var$getLogsFromFirestore() {\n    let q = (0, $9HrqM.query)((0, $9HrqM.collection)((0, $47Mwn.db), \"logs\", $1395f6bf4db21581$var$userId, \"logs\"), (0, $9HrqM.orderBy)(\"addTime\", \"desc\"));\n    return await (0, $9HrqM.getDocs)(q);\n}\nasync function $1395f6bf4db21581$var$addLogToFirestore(title, author, genre, rating, thoughts) {\n    let newLog = await (0, $9HrqM.addDoc)((0, $9HrqM.collection)((0, $47Mwn.db), \"logs\", $1395f6bf4db21581$var$userId, \"logs\"), {\n        title: title,\n        author: author,\n        genre: genre,\n        rating: rating,\n        thoughts: thoughts,\n        addTime: (0, $9HrqM.Timestamp).now()\n    });\n    return newLog.id;\n}\nasync function $1395f6bf4db21581$var$renderLogs() {\n    if (!$1395f6bf4db21581$var$logs) {\n        $1395f6bf4db21581$var$logs = [];\n        let dbData = await $1395f6bf4db21581$var$getLogsFromFirestore();\n        dbData.docs.forEach((book)=>{\n            let data = book.data();\n            $1395f6bf4db21581$var$logs.push({\n                id: book.id,\n                data: {\n                    title: data.title,\n                    author: data.author,\n                    genre: data.genre,\n                    rating: parseInt(data.rating),\n                    thoughts: data.thoughts\n                }\n            });\n        });\n    }\n    $1395f6bf4db21581$var$logList.innerHTML = \"\";\n    $1395f6bf4db21581$var$logs.forEach((book)=>{\n        let data = book.data;\n        $1395f6bf4db21581$var$updateAuthorFilter(data.author);\n        $1395f6bf4db21581$var$updateGenreFilter(data.genre);\n        if ($1395f6bf4db21581$var$authorFilter.value.length == 0 && $1395f6bf4db21581$var$genreFilter.value.length == 0) $1395f6bf4db21581$var$createBookItem(book.id, data.title, data.author, data.genre, data.rating, data.thoughts);\n        else if ($1395f6bf4db21581$var$authorFilter.value == 0 && $1395f6bf4db21581$var$genreFilter.value == data.genre) $1395f6bf4db21581$var$createBookItem(book.id, data.title, data.author, data.genre, data.rating, data.thoughts);\n        else if ($1395f6bf4db21581$var$authorFilter.value == data.author && $1395f6bf4db21581$var$genreFilter.value == 0) $1395f6bf4db21581$var$createBookItem(book.id, data.title, data.author, data.genre, data.rating, data.thoughts);\n        else if ($1395f6bf4db21581$var$authorFilter.value == data.author && $1395f6bf4db21581$var$genreFilter.value == data.genre) $1395f6bf4db21581$var$createBookItem(book.id, data.title, data.author, data.genre, data.rating, data.thoughts);\n    });\n}\nfunction $1395f6bf4db21581$var$updateAuthorFilter(newAuthor) {\n    if (!$1395f6bf4db21581$var$authors.includes(newAuthor)) {\n        $1395f6bf4db21581$var$authors.push(newAuthor);\n        $1395f6bf4db21581$var$authors.sort();\n        $1395f6bf4db21581$var$authorFilter.innerHTML = \"\";\n        let unselectedFilter = document.createElement('option');\n        unselectedFilter.value = '';\n        unselectedFilter.innerText = \"Author\";\n        $1395f6bf4db21581$var$authorFilter.appendChild(unselectedFilter);\n        $1395f6bf4db21581$var$authors.forEach((author)=>{\n            let filter = document.createElement('option');\n            filter.value = author;\n            filter.innerText = author;\n            $1395f6bf4db21581$var$authorFilter.appendChild(filter);\n        });\n    }\n}\nfunction $1395f6bf4db21581$var$updateGenreFilter(newGenre) {\n    if (!$1395f6bf4db21581$var$genres.includes(newGenre)) {\n        $1395f6bf4db21581$var$genres.push(newGenre);\n        $1395f6bf4db21581$var$genres.sort();\n        $1395f6bf4db21581$var$genreFilter.innerHTML = \"\";\n        let unselectedFilter = document.createElement('option');\n        unselectedFilter.value = '';\n        unselectedFilter.innerText = \"Genre\";\n        $1395f6bf4db21581$var$genreFilter.appendChild(unselectedFilter);\n        $1395f6bf4db21581$var$genres.forEach((genre)=>{\n            let filter = document.createElement('option');\n            filter.value = genre;\n            filter.innerText = genre;\n            $1395f6bf4db21581$var$genreFilter.appendChild(filter);\n        });\n    }\n}\nfunction $1395f6bf4db21581$var$createBookItem(id, title, author, genre, rating, thoughts, newLog = false) {\n    let itemTitle = document.createElement('h3');\n    itemTitle.innerText = title;\n    let itemRating = document.createElement('p');\n    let ratingText = \"\";\n    for(let i = 1; i <= rating; i++)ratingText += \"\\u2605\";\n    itemRating.innerText = ratingText.padEnd(5, \"\\u2606\");\n    itemRating.ariaLabel = `Rated ${rating} of 5`;\n    let itemAuthor = document.createElement('p');\n    itemAuthor.innerText = author;\n    itemAuthor.ariaLabel = `By ${author}`;\n    let itemGenre = document.createElement('p');\n    itemGenre.innerText = genre;\n    itemGenre.ariaLabel = `Genre ${genre}`;\n    let itemData = document.createElement('div');\n    itemData.appendChild(itemTitle);\n    itemData.appendChild(itemRating);\n    itemData.appendChild(itemAuthor);\n    itemData.appendChild(itemGenre);\n    let itemThoughts = document.createElement('p');\n    itemThoughts.innerText = thoughts;\n    let listItem = document.createElement('li');\n    listItem.appendChild(itemData);\n    listItem.appendChild(itemThoughts);\n    if (newLog) $1395f6bf4db21581$var$logList.prepend(listItem);\n    else $1395f6bf4db21581$var$logList.appendChild(listItem);\n}\nfunction $1395f6bf4db21581$var$sanitizeInput(input) {\n    const replacements = {\n        '<': '&lt;',\n        '>': '&gt;',\n        '\"': '&quot;',\n        \"'\": '&#39;',\n        '&': '&amp;',\n        '/': '&#x2F;'\n    };\n    return input.replace(/[<>\"'&/]/g, (c)=>replacements[c]);\n}\nasync function $1395f6bf4db21581$var$addNewBook(e) {\n    e.preventDefault();\n    let formData = new FormData(e.target);\n    let values = Object.fromEntries(formData.entries());\n    let title = $1395f6bf4db21581$var$sanitizeInput(values.title.trim());\n    let author = $1395f6bf4db21581$var$sanitizeInput(values.author.trim());\n    let genre = $1395f6bf4db21581$var$sanitizeInput(values.genre.trim());\n    let rating = parseInt(values.rating);\n    let thoughts = $1395f6bf4db21581$var$sanitizeInput(values.thoughts.trim());\n    let error = false;\n    if (title.length < 1) error = true;\n    else if (author.length < 1) error = true;\n    else if (genre.length < 1) error = true;\n    else if (thoughts.length < 1) error = true;\n    if (error) {\n        alert('You must fill in all fields.');\n        return;\n    }\n    $1395f6bf4db21581$var$addBookSection.style.display = 'none';\n    $1395f6bf4db21581$var$addBook.reset();\n    let id = await $1395f6bf4db21581$var$addLogToFirestore(title, author, genre, rating, thoughts);\n    $1395f6bf4db21581$var$logs.push({\n        id: id,\n        data: {\n            title: title,\n            author: author,\n            genre: genre,\n            rating: parseInt(rating),\n            thoughts: thoughts\n        }\n    });\n    $1395f6bf4db21581$var$createBookItem(id, title, author, genre, rating, thoughts, true);\n}\nwindow.addEventListener('load', ()=>{\n    document.getElementById('logout').addEventListener('click', ()=>{\n        localStorage.removeItem(\"email\");\n        window.location.href = \"index.html\";\n    });\n    $1395f6bf4db21581$var$logList = document.getElementById('logList');\n    $1395f6bf4db21581$var$authorFilter = document.getElementById('authorFilter');\n    $1395f6bf4db21581$var$authorFilter.addEventListener('change', ()=>{\n        $1395f6bf4db21581$var$renderLogs();\n    });\n    $1395f6bf4db21581$var$genreFilter = document.getElementById('genreFilter');\n    $1395f6bf4db21581$var$genreFilter.addEventListener('change', ()=>{\n        $1395f6bf4db21581$var$renderLogs();\n    });\n    document.getElementById('add').addEventListener('click', ()=>{\n        $1395f6bf4db21581$var$addBookSection.style.display = 'block';\n    });\n    document.getElementById('closeAdd').addEventListener('click', ()=>{\n        $1395f6bf4db21581$var$addBookSection.style.display = 'none';\n        $1395f6bf4db21581$var$addBook.reset();\n    });\n    $1395f6bf4db21581$var$addBookSection = document.getElementById('addBookSection');\n    $1395f6bf4db21581$var$addBook = document.getElementById('addBook');\n    $1395f6bf4db21581$var$addBook.addEventListener('submit', $1395f6bf4db21581$var$addNewBook);\n    $1395f6bf4db21581$var$renderLogs();\n}); /* async function test() {\n  let j = await getLogsFromFirestore();\n  j.docs.forEach(l => {\n    console.log(l.id, l.data());\n  })\n}\ntest(); */ \n\n\n//# sourceMappingURL=logs.afc81b64.js.map\n","import log from 'loglevel';\nimport { db } from './firebase';\nimport { addDoc, collection, getDocs, orderBy, query, Timestamp } from '@firebase/firestore';\n\nlog.setLevel(\"info\");\nlog.info(\"Application started\");\n\nlet logList;\nlet authorFilter;\nlet genreFilter;\nlet addBookSection;\nlet addBook;\n\nlet logs;\nlet authors = [];\nlet genres = [];\n\nconst email = JSON.parse(localStorage.getItem(\"email\"));\nconst userId = JSON.parse(localStorage.getItem(\"userID\"));\n\nif(!email){\n  window.location.href = \"index.html\";\n}\n\nasync function getLogsFromFirestore() {\n  let q = query(collection(db, \"logs\", userId, \"logs\"), orderBy(\"addTime\", \"desc\"));\n  return await getDocs(q);\n}\n\nasync function addLogToFirestore(title, author, genre, rating, thoughts) {\n  let newLog = await addDoc(collection(db, \"logs\", userId, \"logs\"), {\n    title: title,\n    author: author,\n    genre: genre,\n    rating: rating,\n    thoughts: thoughts,\n    addTime: Timestamp.now()\n  });\n  return newLog.id;\n}\n\nasync function renderLogs() {\n  if (!logs) {\n    logs = [];\n    let dbData = await getLogsFromFirestore();\n    dbData.docs.forEach(book => {\n      let data = book.data();\n      logs.push({\n        id: book.id,\n        data: {\n          title: data.title,\n          author: data.author,\n          genre: data.genre,\n          rating: parseInt(data.rating),\n          thoughts: data.thoughts\n        }\n      })\n    })\n  }\n  logList.innerHTML = \"\";\n  logs.forEach(book => {\n    let data = book.data;\n    updateAuthorFilter(data.author);\n    updateGenreFilter(data.genre);\n    if (authorFilter.value.length == 0 && genreFilter.value.length == 0) {\n      createBookItem(book.id, data.title, data.author, data.genre, data.rating, data.thoughts);\n    } else if (authorFilter.value == 0 && genreFilter.value == data.genre) {\n      createBookItem(book.id, data.title, data.author, data.genre, data.rating, data.thoughts);\n    } else if (authorFilter.value == data.author && genreFilter.value == 0) {\n      createBookItem(book.id, data.title, data.author, data.genre, data.rating, data.thoughts);\n    } else if (authorFilter.value == data.author && genreFilter.value == data.genre) {\n      createBookItem(book.id, data.title, data.author, data.genre, data.rating, data.thoughts);\n    }\n  });\n}\n\nfunction updateAuthorFilter(newAuthor) {\n  if (!authors.includes(newAuthor)) {\n    authors.push(newAuthor);\n    authors.sort();\n    \n    authorFilter.innerHTML = \"\";\n    let unselectedFilter = document.createElement('option');\n    unselectedFilter.value = '';\n    unselectedFilter.innerText = \"Author\"\n    authorFilter.appendChild(unselectedFilter);\n    authors.forEach((author) => {\n      let filter = document.createElement('option');\n      filter.value = author;\n      filter.innerText = author\n      authorFilter.appendChild(filter);\n    });\n  }\n}\n\nfunction updateGenreFilter(newGenre) {\n  if (!genres.includes(newGenre)) {\n    genres.push(newGenre);\n    genres.sort();\n\n    genreFilter.innerHTML = \"\";\n    let unselectedFilter = document.createElement('option');\n    unselectedFilter.value = '';\n    unselectedFilter.innerText = \"Genre\"\n    genreFilter.appendChild(unselectedFilter);\n    genres.forEach((genre) => {\n      let filter = document.createElement('option');\n      filter.value = genre;\n      filter.innerText = genre\n      genreFilter.appendChild(filter);\n    });\n  }\n}\n\nfunction createBookItem(id, title, author, genre, rating, thoughts, newLog = false) {\n  let itemTitle = document.createElement('h3');\n  itemTitle.innerText = title;\n\n  let itemRating = document.createElement('p');\n  let ratingText = \"\";\n  for (let i = 1; i <= rating; i++) {\n    ratingText += \"★\";\n  }\n  itemRating.innerText = ratingText.padEnd(5, '☆');\n  itemRating.ariaLabel = `Rated ${rating} of 5`;\n\n  let itemAuthor = document.createElement('p');\n  itemAuthor.innerText = author;\n  itemAuthor.ariaLabel = `By ${author}`\n\n  let itemGenre = document.createElement('p')\n  itemGenre.innerText = genre;\n  itemGenre.ariaLabel = `Genre ${genre}`\n\n  let itemData = document.createElement('div');\n  itemData.appendChild(itemTitle);\n  itemData.appendChild(itemRating);\n  itemData.appendChild(itemAuthor);\n  itemData.appendChild(itemGenre);\n\n  let itemThoughts = document.createElement('p');\n  itemThoughts.innerText = thoughts;\n\n  let listItem = document.createElement('li');\n  listItem.appendChild(itemData);\n  listItem.appendChild(itemThoughts);\n\n  if (newLog) {\n    logList.prepend(listItem);\n  } else {\n    logList.appendChild(listItem);\n  }\n}\n\nfunction sanitizeInput(input) {\n  const replacements = {\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '&': '&amp;',\n    '/': '&#x2F;'\n  };\n  \n  return input.replace(/[<>\"'&/]/g, c => replacements[c]);\n}\n\nasync function addNewBook(e) {\n  e.preventDefault();\n  let formData = new FormData(e.target);\n  let values = Object.fromEntries(formData.entries());\n  let title = sanitizeInput(values.title.trim());\n  let author = sanitizeInput(values.author.trim());\n  let genre = sanitizeInput(values.genre.trim());\n  let rating = parseInt(values.rating);\n  let thoughts = sanitizeInput(values.thoughts.trim());\n\n  let error = false;\n\n  if (title.length < 1) {\n    error = true;\n  } else if (author.length < 1) {\n    error = true;\n  } else if (genre.length < 1) {\n    error = true;\n  } else if (thoughts.length < 1) {\n    error = true;\n  }\n\n  if (error) {\n    alert('You must fill in all fields.');\n    return;\n  }\n  addBookSection.style.display = 'none';\n  addBook.reset();\n  let id = await addLogToFirestore(title, author, genre, rating, thoughts);\n  logs.push({\n    id: id,\n    data: {\n      title: title,\n      author: author,\n      genre: genre,\n      rating: parseInt(rating),\n      thoughts: thoughts\n    }\n  });\n\n  createBookItem(id, title, author, genre, rating, thoughts, true);\n}\n\nwindow.addEventListener('load', () => {\n  document.getElementById('logout').addEventListener('click', () => {\n    localStorage.removeItem(\"email\");\n    window.location.href = \"index.html\"\n  });\n\n  logList = document.getElementById('logList');\n\n  authorFilter = document.getElementById('authorFilter');\n  authorFilter.addEventListener('change', () => {\n    renderLogs();\n  });\n  genreFilter = document.getElementById('genreFilter')\n  genreFilter.addEventListener('change', () => {\n    renderLogs();\n  });\n\n  document.getElementById('add').addEventListener('click', () => {\n    addBookSection.style.display = 'block';\n  });\n  document.getElementById('closeAdd').addEventListener('click', () => {\n    addBookSection.style.display = 'none';\n    addBook.reset();\n  })\n  addBookSection = document.getElementById('addBookSection');\n  addBook = document.getElementById('addBook');\n  addBook.addEventListener('submit', addNewBook)\n\n  renderLogs();\n});\n\n/* async function test() {\n  let j = await getLogsFromFirestore();\n  j.docs.forEach(l => {\n    console.log(l.id, l.data());\n  })\n}\ntest(); */"],"names":["$1395f6bf4db21581$var$logList","$1395f6bf4db21581$var$authorFilter","$1395f6bf4db21581$var$genreFilter","$1395f6bf4db21581$var$addBookSection","$1395f6bf4db21581$var$addBook","$1395f6bf4db21581$var$logs","$parcel$interopDefault","a","__esModule","default","$parcel$global","globalThis","$parcel$modules","$parcel$inits","parcelRequire","id","exports","init","module","call","err","Error","code","register","$lR3v8","$47Mwn","$9HrqM","setLevel","info","$1395f6bf4db21581$var$authors","$1395f6bf4db21581$var$genres","$1395f6bf4db21581$var$email","JSON","parse","localStorage","getItem","$1395f6bf4db21581$var$userId","$1395f6bf4db21581$var$getLogsFromFirestore","q","query","collection","db","orderBy","getDocs","$1395f6bf4db21581$var$addLogToFirestore","title","author","genre","rating","thoughts","newLog","addDoc","addTime","Timestamp","now","$1395f6bf4db21581$var$renderLogs","dbData","docs","forEach","book","data","push","parseInt","innerHTML","$1395f6bf4db21581$var$updateAuthorFilter","newAuthor","includes","sort","unselectedFilter","document","createElement","value","innerText","appendChild","filter","$1395f6bf4db21581$var$updateGenreFilter","newGenre","length","$1395f6bf4db21581$var$createBookItem","itemTitle","itemRating","ratingText","i","padEnd","ariaLabel","itemAuthor","itemGenre","itemData","itemThoughts","listItem","prepend","$1395f6bf4db21581$var$sanitizeInput","input","replacements","replace","c","$1395f6bf4db21581$var$addNewBook","e","preventDefault","values","Object","fromEntries","formData","FormData","target","entries","trim","error","alert","style","display","reset","window","location","href","addEventListener","getElementById","removeItem"],"version":3,"file":"logs.afc81b64.js.map"}